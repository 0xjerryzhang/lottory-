<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸é‹å½©ç¥¨åŠ©æ‰‹ - å¤§æ¨‚é€ & é›™è‰²çƒ</title>
    <meta name="description" content="æ™ºèƒ½æ•¸æ“šé¸è™Ÿå·¥å…·ï¼Œæ”¯æ´è¶…ç´šå¤§æ¨‚é€èˆ‡é›™è‰²çƒ">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Roboto+Mono:wght@500&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f2f5;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .ball {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: 'Roboto Mono', monospace;
            font-size: 1.1rem;
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.2), 2px 2px 4px rgba(0,0,0,0.1);
            position: relative;
            user-select: none;
            transition: transform 0.2s;
        }
        @media (min-width: 640px) {
            .ball { width: 2.75rem; height: 2.75rem; font-size: 1.15rem; }
        }

        .ball:hover { transform: scale(1.1); }

        .ball::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 15%;
            width: 30%;
            height: 30%;
            background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0));
            border-radius: 50%;
        }

        .ball-red {
            background: linear-gradient(145deg, #ff6b6b, #c92a2a);
            color: white;
            border: 1px solid #b92b27;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.2);
        }

        .ball-blue {
            background: linear-gradient(145deg, #4dabf7, #1864ab);
            color: white;
            border: 1px solid #1864ab;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.2);
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        @keyframes rollIn {
            0% { transform: translateY(-20px) rotate(-180deg); opacity: 0; }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }
        .animate-roll { animation: rollIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .tab-active {
            background-color: white;
            color: #dc2626;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-weight: bold;
        }
        .tab-inactive {
            color: #6b7280;
            background-color: transparent;
        }
        .tab-inactive:hover { background-color: rgba(255,255,255,0.5); }
    </style>
</head>
<body class="min-h-screen py-6 px-3 lg:px-8 text-gray-800">

    <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <!-- Header -->
        <div class="lg:col-span-12 flex flex-col md:flex-row justify-between items-end mb-2 gap-4">
            <div>
                <h1 class="text-3xl font-black text-gray-800 tracking-tight flex items-center gap-3">
                    <span class="bg-gradient-to-r from-red-600 to-orange-500 text-transparent bg-clip-text">å¹¸é‹å½©ç¥¨åŠ©æ‰‹</span>
                    <span class="text-xs bg-gray-800 text-white px-2 py-1 rounded-md font-normal tracking-wide">PROç‰ˆ</span>
                </h1>
                <p class="text-sm text-gray-500 mt-1 font-medium">åŸºæ–¼æ­·å²å¤§æ•¸æ“šæ¬Šé‡é‹ç®—æ¨¡å‹</p>
            </div>
            
            <!-- Type Switcher Tabs -->
            <div class="flex p-1 bg-gray-200/80 rounded-xl w-full md:w-auto">
                <button onclick="switchLottery('dlt')" id="tab-dlt" class="flex-1 md:w-32 py-2 px-4 rounded-lg text-sm transition-all flex items-center justify-center gap-2 tab-active">
                    è¶…ç´šå¤§æ¨‚é€
                </button>
                <button onclick="switchLottery('ssq')" id="tab-ssq" class="flex-1 md:w-32 py-2 px-4 rounded-lg text-sm transition-all flex items-center justify-center gap-2 tab-inactive">
                    é›™è‰²çƒ
                </button>
            </div>
        </div>

        <!-- Left: Generator (7 cols) -->
        <div class="lg:col-span-7 space-y-6">
            
            <!-- Main Console -->
            <div class="glass-panel rounded-2xl p-6 border-t-4 border-red-500 relative overflow-hidden transition-colors duration-500" id="main-panel">
                <!-- Background Icon -->
                <div class="absolute -top-6 -right-6 text-gray-100 transform rotate-12 pointer-events-none">
                    <i class="fas fa-ticket-alt text-9xl opacity-50"></i>
                </div>

                <!-- Info Bar -->
                <div class="flex justify-between items-center mb-6 relative z-10">
                    <div class="flex items-center gap-2">
                        <span id="lottery-badge" class="px-2 py-1 bg-red-100 text-red-600 text-xs font-bold rounded">è¶…ç´šå¤§æ¨‚é€</span>
                        <div class="flex items-center gap-1 bg-white/60 px-3 py-1.5 rounded-lg border border-gray-200">
                            <i class="fas fa-microchip text-blue-500 text-xs"></i>
                            <select id="algo-select" class="text-sm bg-transparent font-bold text-gray-700 outline-none cursor-pointer w-24 sm:w-auto">
                                <option value="weighted">æ™ºèƒ½ç†±è™Ÿ</option>
                                <option value="random">å®Œå…¨éš¨æ©Ÿ</option>
                                <option value="contrarian">è¿½å†·æå†·</option>
                            </select>
                        </div>
                    </div>
                    <div class="text-xs text-gray-400 font-mono hidden sm:block">
                        <span id="rule-text">å‰å€35é¸5 + å¾Œå€12é¸2</span>
                    </div>
                </div>

                <!-- Balls Display Area -->
                <div id="balls-area" class="min-h-[100px] flex flex-wrap justify-center items-center gap-2 sm:gap-3 mb-8 bg-gradient-to-b from-white to-gray-50 rounded-xl p-6 border border-gray-200 shadow-inner">
                    <div class="text-center py-4">
                        <i class="fas fa-fingerprint text-4xl text-gray-200 mb-2"></i>
                        <p class="text-gray-400 text-sm">é»æ“ŠæŒ‰éˆ•å•Ÿå‹•æ™ºèƒ½é‹ç®—</p>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 relative z-10">
                    <button onclick="generateLottery(1)" class="group bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg shadow-red-200 transform active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-magic group-hover:rotate-12 transition-transform"></i> 
                        <span>ç”Ÿæˆä¸€æ³¨</span>
                    </button>
                    <div class="flex gap-2">
                        <button onclick="generateLottery(5)" class="flex-1 bg-white border-2 border-gray-100 text-gray-700 font-bold py-3 px-4 rounded-xl hover:bg-gray-50 hover:border-red-100 transition-all active:scale-95">
                            5 æ³¨é€£ç™¼
                        </button>
                        <button onclick="copyResults()" title="è¤‡è£½çµæœ" class="flex-none w-16 bg-white border-2 border-gray-100 text-gray-600 font-bold py-3 px-4 rounded-xl hover:bg-blue-50 hover:text-blue-600 hover:border-blue-100 transition-all active:scale-95 flex items-center justify-center">
                            <i class="far fa-copy text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- History -->
            <div class="glass-panel rounded-2xl p-5">
                <div class="flex justify-between items-center mb-4 border-b border-gray-100 pb-2">
                    <h3 class="font-bold text-gray-700 text-sm flex items-center gap-2">
                        <i class="fas fa-history text-gray-400"></i> <span id="history-title">å¤§æ¨‚é€è¨˜éŒ„</span>
                    </h3>
                    <button onclick="clearHistory()" class="text-xs text-red-400 hover:text-red-600 transition-colors px-2 py-1 rounded hover:bg-red-50">
                        æ¸…ç©º
                    </button>
                </div>
                <div id="history-container" class="space-y-2 max-h-[250px] overflow-y-auto pr-2 custom-scrollbar">
                    <div class="text-center text-xs text-gray-400 py-10">å°šç„¡æ•¸æ“š</div>
                </div>
            </div>
        </div>

        <!-- Right: Dashboard (5 cols) -->
        <div class="lg:col-span-5 space-y-6">
            
            <!-- Analysis Card -->
            <div class="glass-panel rounded-2xl p-6 border-t-4 border-blue-500 h-full flex flex-col">
                <div class="mb-6">
                    <h3 class="font-bold text-gray-800 text-lg flex items-center gap-2">
                        <i class="fas fa-chart-pie text-blue-500"></i> è¿‘100æœŸå¤§æ•¸æ“š
                    </h3>
                    <p class="text-xs text-gray-500" id="stats-subtitle">è¶…ç´šå¤§æ¨‚é€ - æ­·å²é »ç‡åˆ†æ</p>
                </div>
                
                <!-- Front Zone Stats -->
                <div class="mb-6 bg-white/50 p-4 rounded-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-gray-600">ğŸ”¥ ç´…çƒç†±é–€ Top 5</span>
                        <span class="text-xs text-gray-400 bg-gray-100 px-2 rounded-full" id="front-range-badge">1-35</span>
                    </div>
                    <div id="front-hot-stats" class="grid grid-cols-5 gap-2">
                        <!-- JS Filled -->
                    </div>
                </div>

                <!-- Back Zone Stats -->
                <div class="mb-6 bg-white/50 p-4 rounded-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-gray-600">ğŸ’ è—çƒç†±é–€ Top 3</span>
                        <span class="text-xs text-gray-400 bg-gray-100 px-2 rounded-full" id="back-range-badge">1-12</span>
                    </div>
                    <div id="back-hot-stats" class="grid grid-cols-3 gap-2">
                        <!-- JS Filled -->
                    </div>
                </div>

                <!-- Chart -->
                <div class="flex-1 min-h-[150px]">
                    <p class="text-xs font-bold text-gray-400 mb-2">å¥‡å¶åˆ†ä½ˆè¶¨å‹¢æ¨¡æ“¬</p>
                    <div class="relative h-full w-full">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center text-gray-400 text-xs py-8">
        <p>æœ¬å·¥å…·åƒ…ä¾›å¨›æ¨‚èˆ‡çµ±è¨ˆåƒè€ƒï¼Œä¸ä¿è­‰ä¸­çã€‚</p>
    </div>

    <div id="toast" class="fixed top-6 left-1/2 transform -translate-x-1/2 bg-gray-800/90 text-white px-6 py-3 rounded-full shadow-2xl opacity-0 transition-all duration-300 pointer-events-none z-50 flex items-center gap-3 backdrop-blur-sm">
        <div class="bg-green-500 rounded-full p-1"><i class="fas fa-check text-xs"></i></div>
        <span id="toast-msg" class="text-sm font-medium">æ“ä½œæˆåŠŸ</span>
    </div>

    <script>
        // --- Configuration & Data Source ---
        const CONFIG = {
            dlt: {
                name: "è¶…ç´šå¤§æ¨‚é€",
                color: "red",
                rule: "å‰å€35é¸5 + å¾Œå€12é¸2",
                front: { max: 35, count: 5 },
                back: { max: 12, count: 2 },
                data: {
                    front: { hot: [13, 22, 30, 07, 28, 04, 35, 19], cold: [03, 11, 24, 08, 15] },
                    back: { hot: [03, 07, 10, 01], cold: [05, 12, 06] }
                }
            },
            ssq: {
                name: "é›™è‰²çƒ",
                color: "rose", // distinct color theme
                rule: "ç´…çƒ33é¸6 + è—çƒ16é¸1",
                front: { max: 33, count: 6 },
                back: { max: 16, count: 1 },
                data: {
                    front: { hot: [06, 17, 25, 33, 12, 01, 19, 29], cold: [02, 15, 22, 09] }, // SSQ specific mock data
                    back: { hot: [12, 06, 01, 16], cold: [04, 11] }
                }
            }
        };

        let currentType = 'dlt';
        let weights = { front: {}, back: {} };
        let chartInstance = null;

        // --- Core Logic ---

        function initWeights() {
            const cfg = CONFIG[currentType];
            const data = cfg.data;
            weights = { front: {}, back: {} };

            // Initialize Front Weights
            for(let i=1; i<=cfg.front.max; i++) weights.front[i] = 10;
            data.front.hot.forEach(n => weights.front[n] = 35);
            data.front.cold.forEach(n => weights.front[n] = 4);

            // Initialize Back Weights
            for(let i=1; i<=cfg.back.max; i++) weights.back[i] = 10;
            data.back.hot.forEach(n => weights.back[n] = 30);
            data.back.cold.forEach(n => weights.back[n] = 5);
        }

        function getWeightedRandom(pool, weightsObj, strategy) {
            let totalWeight = 0;
            const tempPool = pool.map(num => {
                let w = weightsObj[num] || 10;
                if (strategy === 'random') w = 10;
                if (strategy === 'contrarian') w = (40 - w);
                totalWeight += w;
                return { num, weight: w };
            });

            const randomVal = Math.random() * totalWeight;
            let currentTotal = 0;
            for (let item of tempPool) {
                currentTotal += item.weight;
                if (randomVal <= currentTotal) return item.num;
            }
            return tempPool[tempPool.length - 1].num;
        }

        function generateSet(strategy) {
            const cfg = CONFIG[currentType];
            
            // Front Zone
            const frontSet = new Set();
            const frontPool = Array.from({length: cfg.front.max}, (_, i) => i + 1);
            let attempts = 0;
            while(frontSet.size < cfg.front.count && attempts < 1000) {
                frontSet.add(getWeightedRandom(frontPool, weights.front, strategy));
                attempts++;
            }

            // Back Zone
            const backSet = new Set();
            const backPool = Array.from({length: cfg.back.max}, (_, i) => i + 1);
            attempts = 0;
            while(backSet.size < cfg.back.count && attempts < 1000) {
                backSet.add(getWeightedRandom(backPool, weights.back, strategy));
                attempts++;
            }

            return {
                front: Array.from(frontSet).sort((a,b)=>a-b),
                back: Array.from(backSet).sort((a,b)=>a-b),
                type: currentType
            };
        }

        // --- UI Logic ---

        function switchLottery(type) {
            if(currentType === type) return;
            currentType = type;

            // Tabs Styling
            document.querySelectorAll('button[id^="tab-"]').forEach(btn => {
                btn.className = btn.id === `tab-${type}` 
                    ? 'flex-1 md:w-32 py-2 px-4 rounded-lg text-sm transition-all flex items-center justify-center gap-2 tab-active'
                    : 'flex-1 md:w-32 py-2 px-4 rounded-lg text-sm transition-all flex items-center justify-center gap-2 tab-inactive';
            });

            // Update UI Texts
            const cfg = CONFIG[type];
            document.getElementById('lottery-badge').textContent = cfg.name;
            document.getElementById('rule-text').textContent = cfg.rule;
            document.getElementById('history-title').textContent = `${cfg.name}è¨˜éŒ„`;
            document.getElementById('stats-subtitle').textContent = `${cfg.name} - æ­·å²é »ç‡åˆ†æ`;
            document.getElementById('front-range-badge').textContent = `1-${cfg.front.max}`;
            document.getElementById('back-range-badge').textContent = `1-${cfg.back.max}`;
            
            // Clear current view
            document.getElementById('balls-area').innerHTML = `
                <div class="text-center py-4">
                    <i class="fas fa-fingerprint text-4xl text-gray-200 mb-2"></i>
                    <p class="text-gray-400 text-sm">å·²åˆ‡æ›è‡³${cfg.name}</p>
                </div>
            `;
            document.getElementById('history-container').innerHTML = '<div class="text-center text-xs text-gray-400 py-10">å°šç„¡æ•¸æ“š</div>';

            // Re-init logic
            initWeights();
            updateDashboard();
        }

        const zeroPad = (n) => n.toString().padStart(2, '0');

        function renderBall(num, type, index) {
            const colorClass = type === 'front' ? 'ball-red' : 'ball-blue';
            return `<div class="ball ${colorClass} animate-roll" style="animation-delay: ${index * 50}ms">
                        ${zeroPad(num)}
                    </div>`;
        }

        async function generateLottery(count) {
            const ballsArea = document.getElementById('balls-area');
            const strategy = document.getElementById('algo-select').value;
            const cfg = CONFIG[currentType];

            ballsArea.innerHTML = `
                <div class="flex flex-col items-center justify-center py-4">
                    <div class="w-10 h-10 border-4 border-red-200 border-t-red-600 rounded-full animate-spin mb-2"></div>
                    <span class="text-xs text-red-500 font-bold tracking-widest">AIé‹ç®—ä¸­...</span>
                </div>
            `;

            await new Promise(r => setTimeout(r, 300));

            const sets = [];
            for(let i=0; i<count; i++) sets.push(generateSet(strategy));

            // Render Main (First Set)
            const mainSet = sets[0];
            let html = '';
            mainSet.front.forEach((n, i) => html += renderBall(n, 'front', i));
            html += `<div class="w-px h-10 bg-gray-300 mx-3 hidden sm:block"></div>`; 
            html += `<div class="w-full sm:hidden h-2"></div>`;
            mainSet.back.forEach((n, i) => html += renderBall(n, 'back', i + cfg.front.count));
            ballsArea.innerHTML = html;

            // Render History
            const historyContainer = document.getElementById('history-container');
            if(historyContainer.querySelector('.text-center')) historyContainer.innerHTML = '';

            [...sets].reverse().forEach(set => {
                const row = document.createElement('div');
                row.className = 'flex justify-between items-center bg-white p-3 rounded-lg border border-gray-100 shadow-sm hover:border-red-200 transition-colors group';
                row.innerHTML = `
                    <div class="font-mono text-sm sm:text-base font-bold">
                        <span class="text-xs text-gray-400 mr-2 bg-gray-100 px-1 rounded">${set.type === 'dlt' ? 'å¤§æ¨‚é€' : 'é›™è‰²çƒ'}</span>
                        <span class="text-red-600">${set.front.map(zeroPad).join(' ')}</span>
                        <span class="mx-2 text-gray-300">|</span>
                        <span class="text-blue-600">${set.back.map(zeroPad).join(' ')}</span>
                    </div>
                    <button onclick="copyText('${formatSetText(set)}')" class="text-gray-300 hover:text-blue-500 p-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-all">
                        <i class="far fa-copy"></i>
                    </button>
                `;
                historyContainer.insertBefore(row, historyContainer.firstChild);
            });
        }

        function formatSetText(set) {
            const name = set.type === 'dlt' ? 'å¤§æ¨‚é€' : 'é›™è‰²çƒ';
            return `${name}: å‰å€[${set.front.map(zeroPad).join(' ')}] å¾Œå€[${set.back.map(zeroPad).join(' ')}]`;
        }

        function copyResults() {
            const historyContainer = document.getElementById('history-container');
            if(historyContainer.querySelector('.text-center')) return showToast('è«‹å…ˆç”Ÿæˆè™Ÿç¢¼');
            
            // Get text from the first history item
            const firstItem = historyContainer.firstChild;
            // Extract numbers - this is a bit hacky but works for UI
            // Better to re-generate text from data if we stored data, but for static page:
            const text = firstItem.querySelector('.font-mono').innerText.replace(/\n/g, ' ');
            copyText(text);
        }

        function copyText(text) {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            showToast('å·²è¤‡è£½ï¼');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').textContent = msg;
            toast.classList.remove('opacity-0', 'pointer-events-none');
            toast.classList.add('top-6');
            setTimeout(() => toast.classList.add('opacity-0', 'pointer-events-none'), 2000);
        }

        function clearHistory() {
            document.getElementById('history-container').innerHTML = '<div class="text-center text-xs text-gray-400 py-10">å°šç„¡æ•¸æ“š</div>';
        }

        function updateDashboard() {
            const cfg = CONFIG[currentType];
            
            // Front Hot
            const frontContainer = document.getElementById('front-hot-stats');
            frontContainer.innerHTML = '';
            cfg.data.front.hot.slice(0, 5).forEach(num => {
                frontContainer.innerHTML += `
                    <div class="flex flex-col items-center bg-red-50 py-2 rounded border border-red-100">
                        <span class="text-lg font-bold text-red-600 font-mono leading-none">${zeroPad(num)}</span>
                    </div>`;
            });

            // Back Hot
            const backContainer = document.getElementById('back-hot-stats');
            backContainer.innerHTML = '';
            cfg.data.back.hot.slice(0, 3).forEach(num => {
                backContainer.innerHTML += `
                    <div class="flex flex-col items-center bg-blue-50 py-2 rounded border border-blue-100">
                        <span class="text-lg font-bold text-blue-600 font-mono leading-none">${zeroPad(num)}</span>
                    </div>`;
            });

            // Update Chart Data (Simulated Difference)
            const newData = currentType === 'dlt' 
                ? [65, 59, 80, 81, 56, 55, 40, 70, 85, 90] 
                : [45, 70, 60, 50, 88, 42, 66, 55, 78, 60];

            if(chartInstance) {
                chartInstance.data.datasets[0].data = newData;
                chartInstance.update();
            }
        }

        function initChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10'],
                    datasets: [{
                        label: 'ç†±åº¦è¶¨å‹¢',
                        data: [65, 59, 80, 81, 56, 55, 40, 70, 85, 90],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { display: false }, y: { display: false } }
                }
            });
        }

        // Init
        initWeights();
        initChart();
        updateDashboard();

    </script>
</body>
</html>
